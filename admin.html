<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ADMIN KEY CONTROL</title>

<style>

*{
box-sizing:border-box;
}

body{
margin:0;
font-family:'Segoe UI',sans-serif;
color:white;
height:100vh;
display:flex;
justify-content:center;
align-items:center;
background:linear-gradient(-45deg,#0f2027,#203a43,#2c5364,#000000);
background-size:400% 400%;
animation:bgMove 18s ease infinite;
overflow:hidden;
}

@keyframes bgMove{
0%{background-position:0% 50%}
50%{background-position:100% 50%}
100%{background-position:0% 50%}
}

.container{
width:460px;
background:rgba(255,255,255,0.06);
backdrop-filter:blur(25px);
border-radius:25px;
padding:25px;
box-shadow:0 20px 60px rgba(0,0,0,0.6);
animation:fadeIn 0.8s ease;
}

@keyframes fadeIn{
from{opacity:0;transform:translateY(20px)}
to{opacity:1;transform:translateY(0)}
}

.header{
font-size:24px;
font-weight:900;
text-align:center;
margin-bottom:20px;
letter-spacing:1px;
background:linear-gradient(90deg,#00f5ff,#00ff99,#00f5ff);
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
}

.sectionTitle{
margin-top:15px;
font-size:13px;
opacity:0.6;
letter-spacing:1px;
}

select,input{
width:100%;
padding:12px;
margin-top:8px;
border-radius:14px;
border:none;
outline:none;
background:rgba(0,0,0,0.6);
color:#00ffcc;
font-size:14px;
transition:0.3s;
}

select:focus,input:focus{
box-shadow:0 0 15px #00ffcc;
}

.button{
margin-top:12px;
padding:12px;
width:100%;
border-radius:16px;
border:none;
cursor:pointer;
font-weight:700;
font-size:14px;
transition:0.3s;
position:relative;
overflow:hidden;
}

.button.primary{
background:linear-gradient(135deg,#00ff99,#00ccff);
color:black;
}

.button.primary:hover{
transform:translateY(-3px);
box-shadow:0 10px 25px rgba(0,255,200,0.5);
}

.button.danger{
background:linear-gradient(135deg,#ff4d4d,#ff0000);
color:white;
}

.button.danger:hover{
transform:translateY(-3px);
box-shadow:0 10px 25px rgba(255,0,0,0.6);
}

.resultBox{
margin-top:15px;
padding:15px;
border-radius:15px;
background:rgba(0,0,0,0.6);
text-align:center;
font-size:18px;
font-weight:bold;
letter-spacing:2px;
color:#00ff99;
}

.listBox{
margin-top:12px;
background:rgba(0,0,0,0.6);
border-radius:15px;
padding:12px;
max-height:130px;
overflow:auto;
font-size:12px;
}

hr{
border:none;
height:1px;
background:rgba(255,255,255,0.1);
margin:6px 0;
}

.smallBtn{
padding:4px 8px;
font-size:11px;
border:none;
border-radius:8px;
cursor:pointer;
background:#222;
color:#00ffcc;
margin-top:4px;
}

.smallBtn:hover{
background:#00ffcc;
color:black;
}

</style>
</head>
<body>

<div class="container">

<div class="header">ADMIN KEY CONTROL</div>

<div class="sectionTitle">TẠO KEY</div>

<select id="type">
<option value="S">1 THIẾT BỊ</option>
<option value="M">ALL THIẾT BỊ</option>
</select>

<select id="timeType">
<option value="hour">THEO GIỜ</option>
<option value="day">THEO NGÀY</option>
<option value="week">THEO TUẦN</option>
</select>

<input type="number" id="timeValue" placeholder="Nhập thời gian">

<button class="button primary" onclick="createKey()">TẠO KEY</button>

<div class="resultBox" id="result">------</div>

<div class="sectionTitle">QUẢN LÝ IP</div>

<input id="banIPInput" placeholder="Nhập IP cần ban">
<button class="button danger" onclick="banIP()">BAN IP</button>

<div class="sectionTitle">IP BỊ BAN</div>
<div class="listBox" id="bannedList"></div>

<div class="sectionTitle">LỊCH SỬ KEY</div>
<div class="listBox" id="keyHistory"></div>

<div class="sectionTitle">LỊCH SỬ LOGIN</div>
<div class="listBox" id="loginHistory"></div>

</div>

<script>

let db = JSON.parse(localStorage.getItem("KEY_DB") || "{}");
if(!db.keys) db.keys={};
if(!db.bannedIPs) db.bannedIPs=[];

function saveDB(){
localStorage.setItem("KEY_DB",JSON.stringify(db));
}

function generateCode(len=4){
let chars="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";
let out="";
for(let i=0;i<len;i++){
out+=chars[Math.floor(Math.random()*chars.length)];
}
return out;
}

function createKey(){

let type=document.getElementById("type").value;
let timeType=document.getElementById("timeType").value;
let value=parseInt(document.getElementById("timeValue").value);

if(!value || value<=0){
alert("Nhập thời gian hợp lệ");
return;
}

let now=Math.floor(Date.now()/1000);
let expire=now;

if(timeType==="hour") expire+=value*3600;
if(timeType==="day") expire+=value*86400;
if(timeType==="week") expire+=value*604800;

let expireCode=expire.toString(36).toUpperCase().slice(-4);
let key=type+generateCode(4)+expireCode;

db.keys[key]={
expire:expire,
created:new Date().toLocaleString(),
logins:[]
};

saveDB();
updateUI();
document.getElementById("result").innerText=key;
}

function deleteKey(key){
delete db.keys[key];
saveDB();
updateUI();
}

function banIP(){
let ip=document.getElementById("banIPInput").value.trim();
if(!ip) return;
if(!db.bannedIPs.includes(ip)){
db.bannedIPs.push(ip);
saveDB();
updateUI();
}
}

function unbanIP(ip){
db.bannedIPs=db.bannedIPs.filter(i=>i!==ip);
saveDB();
updateUI();
}

function updateUI(){

let keyHTML="";
for(let k in db.keys){
keyHTML+=`
<b>${k}</b><br>
Hết hạn: ${new Date(db.keys[k].expire*1000).toLocaleString()}<br>
<button class="smallBtn" onclick="deleteKey('${k}')">XÓA</button>
<hr>
`;
}
document.getElementById("keyHistory").innerHTML=keyHTML||"Chưa có key";

let loginHTML="";
for(let k in db.keys){
db.keys[k].logins.forEach(l=>{
loginHTML+=`
KEY: ${k}<br>
IP: ${l.ip}<br>
Time: ${l.time}
<hr>
`;
});
}
document.getElementById("loginHistory").innerHTML=loginHTML||"Chưa có login";

let banHTML="";
db.bannedIPs.forEach(ip=>{
banHTML+=`
${ip}
<button class="smallBtn" onclick="unbanIP('${ip}')">BỎ BAN</button>
<hr>
`;
});
document.getElementById("bannedList").innerHTML=banHTML||"Không có IP bị ban";
}

updateUI();

</script>

</body>
</html>
